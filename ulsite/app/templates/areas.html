{% extends "base.html" %}

{% load static %}
{% load quest_filters %}

{% block head %}
    <link rel="stylesheet" href="{% static 'css/quest.css' %}?v={% now 'U' %}" />
{% endblock %}

{% block content %}
    <div class="wrap" id="vueApp">
        <img class="topic" src="{% static 'media/world_map.jpg' %}?v={% now 'U' %}" />
        <div class="region_container">
          {% for ar in areas %}
          <div>
            <h2 @click="toggleGroup($event)">
              {{ ar.name }}
            </h2>
            <ul>
              {% for rg in ar.regions.all %}
              <li data-region="{{ rg.name }}"
                  :class="{checked: regions[ '{{ rg.name }}' ] }"
                  @click="toggleRegion('{{ rg.name }}')">
                {{ rg.name }}
              </li>
              {% empty %}
                  <tr>
                    <td colspan="2">尚無資料，請先到<p><a href="/admin/"></a>後台</a></p>新增。</td>  <!--p=plaintext, default display=block-->
                  </tr>
              {% endfor %}
            </ul>
          </div>
          {% empty %}
              尚無資料，請先到<p><a href="/admin/"></a>後台</a></p>新增。
          {% endfor %}
          </div>
        <br />

        <h2>任務清單</h2>
        <table class="comment">
          <tr>
            <td class="emoji">
              <figure><img src="{% static 'media/bluecase.gif' %}?v={% now 'U' %}" /></figure>
            </td>
            <td>
              <p> M1, M2, M3 也包含對應的硬幣和碎片</p>
            </td>
          </tr>
          <tr>
            <td class="emoji">
              <figure><img src="{% static 'media/bluecase.gif' %}?v={% now 'U' %}" /></figure>
            </td>
            <td>
              <p> 金幣, 白金幣也包含對應的碎片</p>
            </td>
          </tr>
        </table>
        <div>
          <label><input type="checkbox" v-model="filters.m1"> M1</label>
          <label><input type="checkbox" v-model="filters.m2"> M2</label>
          <label><input type="checkbox" v-model="filters.m3"> M3</label>
          <label><input type="checkbox" v-model="filters.gold"> 金幣</label>
          <label><input type="checkbox" v-model="filters.platinum"> 白金幣</label>
          <label><input type="checkbox" v-model="filters.boss"> BOSS</label>
          <label><input type="checkbox" v-model="filters.treasure"> 寶圖</label>
        </div>
        <br />
        <table class="searchtime">
          <thead>
            <tr>
              <th>任務名稱</th>
              <th>0分</th>
              <th>3分</th>
              <th>10分</th>
              <th>30分</th>
              <th>1小時</th>
              <th>2小時</th>
              <th>4小時</th>
              <th>8小時</th>
              <th>16小時</th>
              <th>1天</th>
              <th>3天</th>
            </tr>
          </thead>
          <tbody>
            {% for qu in quests %}
              <tr v-show="shouldShow({
                  region:'{{ qu.region.name }}',
                  m1:'{{ qu.m1 }}', m2:'{{ qu.m2 }}', m3:'{{ qu.m3 }}',
                  iron:'{{ qu.iron }}', bronze:'{{ qu.bronze }}',
                  silver:'{{ qu.silver }}', gold:'{{ qu.gold }}',
                  platinum:'{{ qu.platinum }}', memory:'{{ qu.memory }}',
                  time:'{{ qu.time }}', soul:'{{ qu.soul }}',
                  light:'{{ qu.light }}', unlight:'{{ qu.unlight }}',
                  boss:'{{ qu.boss }}', treasure:'{{ qu.treasure }}'
                })"
              >
                <td>{{ qu.name }}</td>
                <td>{{ qu.min0|yesno_o }}</td>
                <td>{{ qu.min3|yesno_o }}</td>
                <td>{{ qu.min10|yesno_o }}</td>
                <td>{{ qu.min30|yesno_o }}</td>
                <td>{{ qu.hr1|yesno_o }}</td>
                <td>{{ qu.hr2|yesno_o }}</td>
                <td>{{ qu.hr4|yesno_o }}</td>
                <td>{{ qu.hr8|yesno_o }}</td>
                <td>{{ qu.hr16|yesno_o }}</td>
                <td>{{ qu.day1|yesno_o }}</td>
                <td>{{ qu.day3|yesno_o }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="2">尚無資料，請先到<p><a href="/admin/"></a>後台</a></p>新增。</td>  <!--p放plaintext-->
              </tr>
            {% endfor %}
          </tbody>
        </table>
    </div>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="{% static 'vue/quest.js' %}?v={% now 'U' %}"></script>
{% endblock %}